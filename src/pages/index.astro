---
import { getCollection } from "astro:content";
import Layout from "../layouts/Layout.astro";
import PostSummary from "@/components/PostSummary.astro";
import { readingTimeMins } from "@/lib/readingTime";

const posts = await getCollection("posts");

const orderedPosts = posts.slice().sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---

<Layout>
  <ul>
    {
      orderedPosts.map((post) => (
        <li class="last:border-b-0 border-b border-neutral-700">
          <PostSummary
            title={post.data.title}
            timestamp={post.data.date.getTime()}
            preview={post.data.preview}
            href={`/posts/${post.id}`}
            tags={post.data.tags}
            timeToReadMins={readingTimeMins(post.rendered?.html ?? "")}
          />
        </li>
      ))
    }
  </ul>
</Layout>
